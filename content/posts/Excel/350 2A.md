```vb
Sub WAR_Pivot_To_Data()

    Dim wsSource As Worksheet
    Dim wsTarget As Worksheet
    Dim pt As PivotTable
    Dim pf As PivotField
    Dim dataRange As Range
    Dim newPt As PivotTable
    Dim tbl As ListObject
    Dim cell As Range
    Dim monthName As String
    
    ' Get the month name first
    monthName = Format(Date, "mmm")

    ' Set source worksheet
    Set wsSource = ThisWorkbook.Sheets("Current Month ETC vs ACWP")
    Set pt = wsSource.PivotTables("PivotTable4")

    ' Delete the sheet if it exists
    Application.DisplayAlerts = False
    On Error Resume Next
    ThisWorkbook.Sheets("WAR" & monthName).Delete
    On Error GoTo 0
    Application.DisplayAlerts = True

    ' Add new sheet
    Set wsTarget = ThisWorkbook.Sheets.Add
    wsTarget.Name = "WAR" & monthName

    If wsTarget Is Nothing Then
        MsgBox "Error: Target worksheet not set."
        Exit Sub
    End If

    ' Copy PivotTable data
    pt.TableRange2.Copy
    wsTarget.Range("A1").PasteSpecial Paste:=xlPasteAll

    ' Get new pivot table if it exists
    On Error Resume Next
    Set newPt = wsTarget.PivotTables(1)
    On Error GoTo 0

    If newPt Is Nothing Then
        MsgBox "Error: PivotTable not set in the new worksheet."
        Exit Sub
    End If

    ' Format PivotTable
    With newPt
        .RowAxisLayout xlTabularRow
        .RepeatAllLabels xlRepeatLabels
        .ShowTableStyleRowStripes = False
        .ShowTableStyleColumnStripes = False
        For Each pf In .RowFields
            pf.Subtotals = Array(False, False, False, False, False, False, False, False, False, False, False, False)
        Next pf
        .ColumnGrand = False
        .RowGrand = False
    End With

    wsTarget.Cells.UnMerge
    wsTarget.Columns("A").UnMerge
    wsTarget.Columns("A:B").UnMerge

    Application.CutCopyMode = False
    wsTarget.Columns("A:C").HorizontalAlignment = xlLeft

    ' Freeze panes
    wsTarget.Rows("4:4").Select
    ActiveWindow.FreezePanes = True

    ' Copy PivotTable data and paste as values
    Set dataRange = newPt.TableRange2
    dataRange.Copy
    dataRange.PasteSpecial Paste:=xlPasteValues

    ' Ensure the data range is set
    If dataRange Is Nothing Then
        MsgBox "Error: Data range not set."
        Exit Sub
    End If

    ' Delete the first two rows
    wsTarget.Rows("1:2").Delete

    ' Delete columns D:K and Q:X
    wsTarget.Range("D:K,Q:X").Delete

    ' Convert the remaining data to a table
    Set tbl = wsTarget.ListObjects.Add(xlSrcRange, wsTarget.Range("A1").CurrentRegion, , xlYes)
    tbl.Name = "WARDataTable"
    tbl.TableStyle = "TableStyleMedium2"

    ' Filter out rows where "Employee Name" is "ETC 1" or "ETC 2"
    With tbl.Range
        .AutoFilter Field:=tbl.ListColumns("Employee Name").Index, Criteria1:="<>ETC 1", Operator:=xlAnd, Criteria2:="<>ETC 2"
    End With

    ' Insert two columns after "Charge Number"
    Dim chargeNumberCol As ListColumn
    Set chargeNumberCol = tbl.ListColumns("Charge Number")

    chargeNumberCol.Range.Offset(0, 1).EntireColumn.Insert
    chargeNumberCol.Range.Offset(0, 1).EntireColumn.Insert

    ' Name the new columns "WP" and "Type of Work"
    chargeNumberCol.Range.Offset(0, 1).Cells(1, 1).Value = "WP"
    chargeNumberCol.Range.Offset(0, 2).Cells(1, 1).Value = "Type of Work"

    ' Insert three columns after "Week 5"
    Dim week5Col As ListColumn
    Set week5Col = tbl.ListColumns("Week 5 ")

    week5Col.Range.Offset(0, 1).EntireColumn.Insert
    week5Col.Range.Offset(0, 1).EntireColumn.Insert
    week5Col.Range.Offset(0, 1).EntireColumn.Insert

    ' Name the new columns "Total week1-2, SP", "Total week3-4, SP", and "Total month, SP"
    week5Col.Range.Offset(0, 1).Cells(1, 1).Value = "Total week1-2, SP"
    week5Col.Range.Offset(0, 2).Cells(1, 1).Value = "Total week3-4, SP"
    week5Col.Range.Offset(0, 3).Cells(1, 1).Value = "Total month, SP"

    ' Find column indexes dynamically
    Dim week1ColIndex As Integer, week2ColIndex As Integer
    Dim week3ColIndex As Integer, week4ColIndex As Integer
    Dim totalWeek12SPColIndex As Integer, totalWeek34SPColIndex As Integer
    Dim totalMonthSPColIndex As Integer
    Dim lastRow As Long
    Dim headerRow As Range
    
    ' Get the header row
    Set headerRow = wsTarget.Rows(1)

    ' Find column indexes
    Dim col As Range
    For Each col In headerRow.Cells
        Select Case col.Value
            Case "Week 1 "
                week1ColIndex = col.Column
            Case "Week 2"
                week2ColIndex = col.Column
            Case "Week 3"
                week3ColIndex = col.Column
            Case "Week 4"
                week4ColIndex = col.Column
            Case "Total week1-2, SP"
                totalWeek12SPColIndex = col.Column
            Case "Total week3-4, SP"
                totalWeek34SPColIndex = col.Column
            Case "Total month, SP"
                totalMonthSPColIndex = col.Column
        End Select
    Next col

    ' Check if required columns exist
    If week1ColIndex = 0 Or week2ColIndex = 0 Or totalWeek12SPColIndex = 0 Then
        MsgBox "Error: Could not find required columns for Total week1-2, SP.", vbCritical
        Exit Sub
    End If

    If week3ColIndex = 0 Or week4ColIndex = 0 Or totalWeek34SPColIndex = 0 Then
        MsgBox "Error: Could not find required columns for Total week3-4, SP.", vbCritical
        Exit Sub
    End If

    If totalMonthSPColIndex = 0 Then
        MsgBox "Error: Could not find required column for Total month, SP.", vbCritical
        Exit Sub
    End If

    ' Get last row
    lastRow = wsTarget.Cells(Rows.Count, "A").End(xlUp).Row

    ' Insert formula in "Total week1-2, SP" column
    Dim formulaRange12 As Range
    Set formulaRange12 = wsTarget.Range(wsTarget.Cells(2, totalWeek12SPColIndex), wsTarget.Cells(lastRow, totalWeek12SPColIndex))
    formulaRange12.FormulaR1C1 = "=(RC" & week1ColIndex & " + RC" & week2ColIndex & ") / 4"

    ' Insert formula in "Total week3-4, SP" column
    Dim formulaRange34 As Range
    Set formulaRange34 = wsTarget.Range(wsTarget.Cells(2, totalWeek34SPColIndex), wsTarget.Cells(lastRow, totalWeek34SPColIndex))
    formulaRange34.FormulaR1C1 = "=(RC" & week3ColIndex & " + RC" & week4ColIndex & ") / 4"

    ' Insert formula in "Total month, SP" column
    Dim formulaRangeMonth As Range
    Set formulaRangeMonth = wsTarget.Range(wsTarget.Cells(2, totalMonthSPColIndex), wsTarget.Cells(lastRow, totalMonthSPColIndex))
    formulaRangeMonth.FormulaR1C1 = "=(RC" & week1ColIndex & " + RC" & week2ColIndex & " + RC" & week3ColIndex & " + RC" & week4ColIndex & ") / 4"

    ' Convert formulas to values
    formulaRange12.Copy
    formulaRange12.PasteSpecial Paste:=xlPasteValues
    formulaRange34.Copy
    formulaRange34.PasteSpecial Paste:=xlPasteValues
    formulaRangeMonth.Copy
    formulaRangeMonth.PasteSpecial Paste:=xlPasteValues
    Application.CutCopyMode = False

    MsgBox "Process completed successfully!", vbInformation

End Sub
```